{"version":3,"sources":["create-component.js"],"names":["flatArray","ALL_ID","LIST_NOT_FOUND","OUTER_TYPE","INNER_TYPE","MAIN_ROOT_LIST","mainRootList","document","querySelector","INNER_BOX_FIELD_TEMPLATE","innerBoxFieldTemplate","INNER_BOX_ITEM_TEMPLATE","innerBoxItemTemplate","OUTER_BOX_FIELD_TEMPLATE","outerBoxFieldTemplate","OUTER_BOX_ITEM_TEMPLATE","outerBoxItemTemplate","SINGLE_FIELD_TEMPLATE","singleFieldTemplate","components","createHtmlStructure","componentArray","fragment","createDocumentFragment","forEach","obj","parentId","id","name","children","setFormField","createSingleField","createOuterBoxField","getTypeOfParentBox","setComponent","createInnerBoxField","typeOfParentBox","createOuterBoxItem","createInnerBoxItem","append","length","element","setIdAndLabel","cloneNode","content","setIdLabelAndSummary","typeOfList","parentList","String","dataset","list","console","log","label","setAttribute","textContent","input","inputId","toLowerCase"],"mappings":"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","file":"create-component.min.js","sourcesContent":["/* eslint-disable no-console */\n'use strict';\n\nimport {flatArray} from './flat-array.min.js';\n\nconst ALL_ID = 'all-';\nconst LIST_NOT_FOUND = 'not found';\nconst OUTER_TYPE = 'outer';\nconst INNER_TYPE = 'inner';\n\nconst MAIN_ROOT_LIST = 'ul[id=\"0\"]';\nconst mainRootList = document.querySelector(MAIN_ROOT_LIST);\n\nconst INNER_BOX_FIELD_TEMPLATE = '#inner_box_form_field';\nconst innerBoxFieldTemplate = document.querySelector(INNER_BOX_FIELD_TEMPLATE);\n\nconst INNER_BOX_ITEM_TEMPLATE = '#inner_box_item';\nconst innerBoxItemTemplate = document.querySelector(INNER_BOX_ITEM_TEMPLATE);\n\nconst OUTER_BOX_FIELD_TEMPLATE = '#outer_box_form_field';\nconst outerBoxFieldTemplate = document.querySelector(OUTER_BOX_FIELD_TEMPLATE);\n\nconst OUTER_BOX_ITEM_TEMPLATE = '#outer_box_item';\nconst outerBoxItemTemplate = document.querySelector(OUTER_BOX_ITEM_TEMPLATE);\n\nconst SINGLE_FIELD_TEMPLATE = '#single_form_field';\nconst singleFieldTemplate = document.querySelector(SINGLE_FIELD_TEMPLATE);\n\nlet components = [];\n\nif (flatArray) {\n  components = flatArray;\n}\n\ncreateHtmlStructure(components);\n\nfunction createHtmlStructure(componentArray) {\n  // фрагмент HTML структуры, которую будем добавлять в корневой список\n  let fragment = document.createDocumentFragment();\n\n  componentArray.forEach((obj) => {\n    let {parentId, id, name, children} = obj;\n\n    if (parentId === 0 && children === false) {\n      let elementSingleField = createSingleField(id, name);\n      setFormField(elementSingleField, fragment);\n    }\n\n    if (parentId === 0 && children === true) {\n      let elementOuterBoxField = createOuterBoxField(id, name);\n      setFormField(elementOuterBoxField, fragment);\n    }\n\n    if (parentId !== 0 && children === true) {\n      // определим существует ли родительский список\n      let typeOfParentBox = getTypeOfParentBox(parentId, fragment);\n\n      if (typeOfParentBox !== LIST_NOT_FOUND) {\n        let innerBoxField = createInnerBoxField(id, name);\n        setComponent(innerBoxField, fragment, parentId);\n      }\n    }\n\n    if (parentId !== 0 && children === false) {\n      // определим в какой список: внешний (outer) или вложенный (inner)\n      // пойдет элемент и существует ли родительский список\n      let typeOfParentBox = getTypeOfParentBox(parentId, fragment);\n\n      if (typeOfParentBox === OUTER_TYPE) {\n        let outerBoxItem = createOuterBoxItem(id, name);\n        setComponent(outerBoxItem, fragment, parentId);\n      }\n\n      if (typeOfParentBox === INNER_TYPE) {\n        let innerBoxItem = createInnerBoxItem(id, name);\n        setComponent(innerBoxItem, fragment, parentId);\n      }\n    }\n  });\n\n  // вставка собранного фрагмента в корневой список\n  mainRootList.append(fragment);\n\n  // очищаем массив компонентов\n  components.length = 0;\n}\n\n// поле формы вставляем в корневой лист (id=\"0\")\nfunction setFormField(element, fragment) {\n  fragment.append(element);\n}\n\n// создаем поле формы в корневом листе (id=\"0\")\nfunction createSingleField(id, name) {\n  let element = singleFieldTemplate.cloneNode(true).content;\n  return setIdAndLabel(element, id, name);\n}\n\nfunction createOuterBoxField(id, name) {\n  let element = outerBoxFieldTemplate.cloneNode(true).content;\n  return setIdLabelAndSummary(element, id, name);\n}\n\n// определяем тип родительского списка\nfunction getTypeOfParentBox(parentId, fragment) {\n  let typeOfList = LIST_NOT_FOUND;\n  let parentList = fragment.querySelector(`ul[id=\"${String(parentId)}\"]`);\n  if (parentList) {\n    typeOfList = parentList.dataset.list;\n  }\n\n  if (typeOfList === LIST_NOT_FOUND) {\n    console.log(`не найден родительский список id=${parentId}`);\n  }\n\n  return typeOfList;\n}\n\n// создаем элемент внешний (inner) списка\nfunction createOuterBoxItem(id, name) {\n  let element = outerBoxItemTemplate.cloneNode(true).content;\n  return setIdAndLabel(element, id, name);\n}\n\n// создаем элемент внешнего(outer) списка\nfunction createInnerBoxItem(id, name) {\n  let element = innerBoxItemTemplate.cloneNode(true).content;\n  return setIdAndLabel(element, id, name);\n}\n\n// создаем элемент корневого (id=\"0\") списка\nfunction createInnerBoxField(id, name) {\n  let element = innerBoxFieldTemplate.cloneNode(true).content;\n  return setIdLabelAndSummary(element, id, name);\n}\n\nfunction setIdAndLabel(element, id, name) {\n  let input = element.querySelector('input');\n  input.id = String(id);\n\n  let label = element.querySelector('label');\n  label.setAttribute('for', id);\n  label.textContent = name;\n\n  return element;\n}\n\nfunction setIdLabelAndSummary(element, id, name) {\n  let summary = element.querySelector('summary');\n  summary.textContent = name;\n\n  let ul = element.querySelector('ul');\n  ul.id = id;\n\n  let input = element.querySelector('input');\n  let inputId = ALL_ID + String(id);\n  input.id = inputId;\n\n  let label = element.querySelector('label');\n  label.setAttribute('for', inputId);\n  label.textContent = `Все ${name.toLowerCase()}`;\n\n  return element;\n}\n\n// установить элемент в нужную позицию относительно его родителя (parentId)\n// во фрагменте\nfunction setComponent(element, fragment, parentId) {\n  let parentList = fragment.querySelector(`ul[id=\"${String(parentId)}\"]`);\n  parentList.append(element);\n}\n"]}